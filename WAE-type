#lang plai

(define-type WAE
  (num (n) number?)
  (add (lhs WAE?)(rhs WAE?))
  (sub (lhs WAE?)(rhs WAE?))
  (with (name symbol?) (named_expr WAE?)
      (body WAE?))
  (id (name symbol?)))

(define calc
  (lambda (a-wae)
    (type-case WAE a-wae
      (num (n) n)
      (add (l r) (+ (calc l) (calc r)))
      (sub (l r) (- (calc l) (calc r)))
      (with (name bound-value body)
        (subst body name bound-value)))))

(define interp
  (lambda (Sexp)
    (calc (parse Sexp))))
